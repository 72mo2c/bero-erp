<!DOCTYPE html>
<html>
<head>
    <title>ุงุฎุชุจุงุฑ ุงูุจูุงูุงุช</title>
    <style>
        body { font-family: Arial; margin: 20px; direction: rtl; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h2>๐ ุงุฎุชุจุงุฑ ุงูุจูุงูุงุช - ุชุดุฎูุต ูุดููุฉ ุงูุตูุญุฉ ุงููุงุฑุบุฉ</h2>
    <div id="result"></div>
    <button onclick="runTest()">ุฅุนุงุฏุฉ ุงููุญุต</button>
    
    <script>
        function runTest() {
            // ูุญุต ุงูุจูุงูุงุช ุงููุญููุธุฉ
            const keys = [
                'org_1_purchaseInvoices',
                'org_1_purchaseReturns', 
                'org_1_products',
                'org_1_suppliers'
            ];
            
            let result = '<h3>๐ ูุญุต localStorage:</h3>';
            let hasData = false;
            
            keys.forEach(key => {
                const data = localStorage.getItem(key);
                const parsedData = data ? JSON.parse(data) : null;
                const length = Array.isArray(parsedData) ? parsedData.length : 'ููุณ ูุตูููุฉ';
                
                if (data && Array.isArray(parsedData) && parsedData.length > 0) {
                    hasData = true;
                    result += `<p class="success">โ <strong>${key}:</strong> ${length} ุนูุตุฑ</p>`;
                } else {
                    result += `<p class="error">โ <strong>${key}:</strong> ูุงุฑุบ ุฃู ุบูุฑ ููุฌูุฏ</p>`;
                }
                
                // ุนุฑุถ ุชูุงุตูู ููุงุชูุฑ ุงููุดุชุฑูุงุช
                if (key === 'org_1_purchaseInvoices' && data) {
                    const invoices = JSON.parse(data);
                    result += '<div style="margin-right: 20px;"><h4>๐ ุนููุฉ ูู ุงูููุงุชูุฑ:</h4><ul>';
                    invoices.slice(0, 5).forEach(inv => {
                        result += `<li>ูุงุชูุฑุฉ ${inv.id} (${typeof inv.id}) - ุงูููุฑุฏ: ${inv.supplierId}</li>`;
                    });
                    if (invoices.length > 5) result += `<li>... ู ${invoices.length - 5} ูุงุชูุฑุฉ ุฃุฎุฑู</li>`;
                    result += '</ul></div>';
                }
            });
            
            // ูุญุต URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const testInvoiceId = urlParams.get('invoiceId') || '1';
            
            result += `<h3>๐ ุงุฎุชุจุงุฑ ุงูุชูุฌูู:</h3>`;
            result += `<p>ุฑุงุจุท ุงุฎุชุจุงุฑ ุงูุฅุฑุฌุงุน: <a href="/purchases/return/${testInvoiceId}" target="_blank">ูุชุญ ุตูุญุฉ ุฅุฑุฌุงุน ูุงุชูุฑุฉ ${testInvoiceId}</a></p>`;
            
            // ูุญุต React DevTools
            result += `<h3>โ๏ธ ูุญุต React:</h3>`;
            if (window.React) {
                result += `<p class="success">โ React ูุญูู: ${React.version}</p>`;
            } else {
                result += `<p class="error">โ React ุบูุฑ ูุญูู</p>`;
            }
            
            // ูุญุต Console Errors
            result += `<h3>๐ ูุญุต ุงูุฃุฎุทุงุก:</h3>`;
            result += `<p class="info">โน๏ธ ุชุญูู ูู Console ููุฃุฎุทุงุก (F12 โ Console)</p>`;
            
            if (!hasData) {
                result += `<div style="background: #ffebee; padding: 15px; border-radius: 5px; margin-top: 20px;">
                    <h4 class="error">โ๏ธ ุงูุณุจุจ ุงููุญุชูู ููุตูุญุฉ ุงููุงุฑุบุฉ:</h4>
                    <p>ูุง ุชูุฌุฏ ุจูุงูุงุช ูู localStorage. ูุฐุง ูุนูู ุฃู:</p>
                    <ul>
                        <li>ุงููุธุงู ูู ูุชู ุงุณุชุฎุฏุงูู ูู ูุจู</li>
                        <li>ุชู ุญุฐู ุงูุจูุงูุงุช</li>
                        <li>ููุงู ูุดููุฉ ูู ุชุญููู ุงูุจูุงูุงุช</li>
                    </ul>
                    <p><strong>ุงูุญู:</strong> ุงุฑุฌุน ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุฃุถู ุจุนุถ ุงูุจูุงูุงุช ุฃููุงู</p>
                </div>`;
            }
            
            document.getElementById('result').innerHTML = result;
        }
        
        // ุชุดุบูู ุงููุญุต ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        window.onload = runTest;
    </script>
</body>
</html>